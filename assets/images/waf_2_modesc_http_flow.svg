<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
    <!-- Styles -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#4834d4"/>
        </marker>
    </defs>
    
    <!-- Client Box -->
    <rect x="50" y="50" width="150" height="300" rx="20" fill="#a8e6cf" stroke="#3d3d3d" stroke-width="2"/>
    <!-- Laptop Icon -->
    <g transform="translate(85, 140)">
        <rect x="0" y="0" width="80" height="60" rx="5" fill="#3d3d3d"/>
        <rect x="5" y="5" width="70" height="50" rx="3" fill="#f5f5f5"/>
        <path d="M-10 60 L90 60 L80 70 L0 70 Z" fill="#3d3d3d"/>
    </g>
    
    <!-- Server Box -->
    <rect x="600" y="50" width="150" height="300" rx="20" fill="#ffd3b6" stroke="#3d3d3d" stroke-width="2"/>
    <rect x="635" y="140" width="80" height="120" rx="5" fill="#3d3d3d"/>
    <circle cx="675" cy="150" r="4" fill="#ff8b94"/>
    <rect x="645" y="165" width="60" height="6" fill="#a8e6cf"/>
    <rect x="645" y="180" width="60" height="6" fill="#a8e6cf"/>
    <rect x="645" y="195" width="60" height="6" fill="#a8e6cf"/>
    
    <!-- WAF Shield -->
    <path d="M300 50 L500 50 L500 300 L400 350 L300 300 Z" fill="#ffaaa5" stroke="#3d3d3d" stroke-width="2"/>

    <!-- Labels -->
    <text x="125" y="40" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Client</text>
    <text x="400" y="40" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">WAF</text>
    <text x="675" y="40" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Server</text>

    <!-- Phase Labels inside shield -->
    <rect x="320" y="80" width="160" height="30" rx="15" fill="#fff"/>
    <text x="330" y="100" font-family="Arial" font-size="12">Phase 1: Request Headers</text>
    
    <rect x="320" y="120" width="160" height="30" rx="15" fill="#fff"/>
    <text x="330" y="140" font-family="Arial" font-size="12">Phase 2: Request Body</text>
    
    <rect x="320" y="180" width="170" height="30" rx="15" fill="#fff"/>  <!-- Increased width -->
    <text x="330" y="200" font-family="Arial" font-size="12">Phase 3: Response Headers</text>
    
    <rect x="320" y="220" width="160" height="30" rx="15" fill="#fff"/>
    <text x="330" y="240" font-family="Arial" font-size="12">Phase 4: Response Body</text>
    
    <rect x="320" y="260" width="160" height="30" rx="15" fill="#fff"/>
    <text x="330" y="280" font-family="Arial" font-size="12">Phase 5: Logging</text>

    <!-- Flow Arrows -->
    <path d="M200 150 L300 150" stroke="#4834d4" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M500 150 L600 150" stroke="#4834d4" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M600 250 L500 250" stroke="#4834d4" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M300 250 L200 250" stroke="#4834d4" stroke-width="2" marker-end="url(#arrowhead)"/>

    <!-- Flow Labels -->
    <text x="250" y="140" font-family="Arial" font-size="12">Request</text>
    <text x="250" y="270" font-family="Arial" font-size="12">Response</text>

</svg>
